---
import type { HolidayCategory } from "@layouts/HolidayLayout/_types/holidayCategory.ts";
import HolidayLayout from "@layouts/HolidayLayout/HolidayLayout.astro";
import { getCollection } from "astro:content";
import { _courses } from "./_data/courses.ts";
import BundleImage from "./_images/black-friday-bundle.png";

const __courses = await getCollection("courses");

const categories: HolidayCategory[] = _courses.map(({ category, courses }) => ({
  category,
  courses: courses.map(({ id, prices }) => ({
    course: __courses.find((_course) => _course.slug === id)!,
    prices,
  })),
}));
const prices = { old: 2630, new: 395 };
---

<HolidayLayout
  annotation="Rock the JVM's annual offer you can't refuse"
  bundleImage={BundleImage}
  bundlePricingPlanId={5951531}
  {categories}
  couponCode="BLACK_FRIDAY_2024"
  description="Everything on Rock the JVM at an outrageous price, available for a limited time"
  forcedTheme="black-friday"
  logoSuffix="-black-friday"
  offer={`... you get a one-time "everything" offer. Everything currently
published ($${prices.old} worth of courses), at an unbeatable price.`}
  {prices}
  slug="black-friday-2024"
  subtitle1="50% off site-wide, valid until EOD Dec 2, 2024."
  subtitle2="Everything must go!"
  title="Black Friday"
/>
